Пример для чтения угла с датчика AS5047P по SPI. Демонстрирует инициализацию кастомной SPI-шины, проверку связи с датчиком и вывод угла в градусах в последовательный порт.
Ознакомьтесь с pinout модуля и драйвера, который будет читать датчик. Светодиод соединен с выводом PA5, который в библиотеке VBCoreG4_arduino_system уже определен как LED2
Подключение SPI3: MOSI = PC12, MISO = PC11, SCLK = PC10 
CS датчика: PA_15_ALT1 
Тут стоит отметить, что в Arduino (stm32duino) каждый пин STM32 может иметь несколько альтернативных функций. В файле PeripheralPins.c перечислены все их варианты. По умолчанию ядро выбирает первый подходящий вариант (например, для PA15 это SPI1_NSS), но если вам нужно использовать другую функцию того же пина (например, SPI3_NSS), придётся указать альтернативное определение — PA_15_ALT1.
Ссылка на файл: https://github.com/stm32duino/Arduino_Core_STM32/blob/main/variants/STM32G4xx/G473R(B-C)T_G473RETx(Z)_G474R(B-C-E)T_G483RET_G484RET/PeripheralPins.c

Если вы хотите работать с датчиком AS5047, то советуем вам установить библиотеку в Arduino IDE не через менеджер библиотек, а с нашего репозитория. Это немного измененная стандартная библиотека AS5047P:
https://github.com/VBCores/AS5047P

Репозиторий оригинальной библиотеки AS5047P с примерами: https://github.com/jonas-merkle/AS5047P
